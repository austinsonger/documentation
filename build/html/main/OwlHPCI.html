

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>OwlH for PCI &mdash; owlh 0.4 - Cloud and Bro documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="owlh 0.4 - Cloud and Bro documentation" href="../index.html"/>
        <link rel="next" title="Software TAP for AWS and GCloud" href="OwlHsoftwaretap.html"/>
        <link rel="prev" title="OwlH - Zeek and Wazuh" href="OwlHBro.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> owlh
          

          
          </a>

          
            
            
              <div class="version">
                0.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="OwlHAbout.html">About OwlH</a><ul>
<li class="toctree-l2"><a class="reference internal" href="OwlHAbout.html#if-you-need-help">If you need help:</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="OwlHatwork.html">How does it work?</a><ul>
<li class="toctree-l2"><a class="reference internal" href="OwlHatwork.html#main-components">Main components</a></li>
<li class="toctree-l2"><a class="reference internal" href="OwlHatwork.html#owlh-nids-node">OwlH NIDS node</a></li>
<li class="toctree-l2"><a class="reference internal" href="OwlHatwork.html#owlh-master-node">OwlH Master node</a></li>
<li class="toctree-l2"><a class="reference internal" href="OwlHatwork.html#elastic-stack">Elastic Stack</a><ul>
<li class="toctree-l3"><a class="reference internal" href="OwlHatwork.html#if-you-need-help">If you need help:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="OwlHWazuh.html">OwlH - Suricata and Wazuh</a><ul>
<li class="toctree-l2"><a class="reference internal" href="OwlHWazuh.html#how-to-easily-integrate-suricata-with-wazuh">How to easily integrate Suricata with Wazuh</a><ul>
<li class="toctree-l3"><a class="reference internal" href="OwlHWazuh.html#main-steps">Main steps</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="OwlHWazuh.html#deploy-suricata-or-use-a-current-suricata-deployment">Deploy Suricata or use a Current Suricata deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="OwlHWazuh.html#configure-suricata-to-store-output-in-json-format-eve-log-configuration">Configure Suricata to store output in JSON format - EVE log configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="OwlHWazuh.html#install-wazuh-stack-if-you-are-not-done-yet">Install Wazuh stack if you are not done yet</a></li>
<li class="toctree-l2"><a class="reference internal" href="OwlHWazuh.html#install-wazuh-agent-in-the-suricata-system">Install Wazuh Agent in the suricata system</a></li>
<li class="toctree-l2"><a class="reference internal" href="OwlHWazuh.html#configure-wazuh-suricata-rules-to-create-right-alarms">Configure Wazuh Suricata rules to create right alarms</a></li>
<li class="toctree-l2"><a class="reference internal" href="OwlHWazuh.html#configure-wazuh-agent-to-read-the-eve-json-output-file">Configure Wazuh Agent to read the eve.json output file</a></li>
<li class="toctree-l2"><a class="reference internal" href="OwlHWazuh.html#if-you-require-pci-configure-owlh-pci-mapping">If you require PCI. Configure OwlH PCI mapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="OwlHWazuh.html#modify-ip-data-mapping">Modify IP data mapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="OwlHWazuh.html#modify-elastic-template">Modify Elastic template</a><ul>
<li class="toctree-l3"><a class="reference internal" href="OwlHWazuh.html#if-you-need-help">If you need help:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="OwlHBro.html">OwlH - Zeek and Wazuh</a><ul>
<li class="toctree-l2"><a class="reference internal" href="OwlHBro.html#integration-logical-diagram">Integration Logical Diagram</a><ul>
<li class="toctree-l3"><a class="reference internal" href="OwlHBro.html#components">Components</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="OwlHBro.html#configure-zeek-owlh-node">Configure - Zeek - OwlH Node</a></li>
<li class="toctree-l2"><a class="reference internal" href="OwlHBro.html#zeek-logs-output-format-to-json">Zeek Logs Output format to JSON</a><ul>
<li class="toctree-l3"><a class="reference internal" href="OwlHBro.html#option-1-modify-ascii-writer-output">Option 1 - Modify ASCII writer output</a></li>
<li class="toctree-l3"><a class="reference internal" href="OwlHBro.html#option-2-use-add-json-package">Option 2 - Use add-json package</a></li>
<li class="toctree-l3"><a class="reference internal" href="OwlHBro.html#zeek-event-enritchment-to-help-wazuh-ruleset">Zeek Event Enritchment to help Wazuh ruleset</a></li>
<li class="toctree-l3"><a class="reference internal" href="OwlHBro.html#loading-zeek-customizations-at-zeek-start">Loading Zeek customizations at Zeek start</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="OwlHBro.html#wazuh-agent-configuration">Wazuh Agent configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="OwlHBro.html#configure-wazuh-manager">Configure - Wazuh Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="OwlHBro.html#wazuh-zeek-ids-rules">Wazuh Zeek IDS Rules</a></li>
<li class="toctree-l2"><a class="reference internal" href="OwlHBro.html#configure-logstash-server">Configure - Logstash Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="OwlHBro.html#logstash-filter">Logstash Filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="OwlHBro.html#review-your-kibana-dashboard">Review your Kibana Dashboard</a><ul>
<li class="toctree-l3"><a class="reference internal" href="OwlHBro.html#if-you-need-help">If you need help:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">OwlH for PCI</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#owlh-can-help-you-to-demonstrate-compliance-with-requirements">OwlH can help you to demonstrate compliance with requirements:</a></li>
<li class="toctree-l2"><a class="reference internal" href="#define-your-custom-rules-to-detect-compliance-related-traffic">Define your custom rules to detect compliance related traffic:</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-to-apply-suricata-pci-mapping">How to apply Suricata PCI Mapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-to-manage-and-custom-your-suricata-pci-mapping">How to manage and custom your Suricata PCI Mapping</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#if-you-need-help">If you need help:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="OwlHsoftwaretap.html">Software TAP for AWS and GCloud</a><ul>
<li class="toctree-l2"><a class="reference internal" href="OwlHsoftwaretap.html#owlh-software-tap-to-monitor-traffic-in-aws-and-gcloud-environments">OwlH Software TAP to monitor traffic in AWS and GCLOUD environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="OwlHsoftwaretap.html#introduction-what-does-sotwaretap-do-and-how-does-it-work">Introduction: What does SotwareTAP do and how does it work?</a></li>
<li class="toctree-l2"><a class="reference internal" href="OwlHsoftwaretap.html#main-components">Main Components</a></li>
<li class="toctree-l2"><a class="reference internal" href="OwlHsoftwaretap.html#owlh-master-orchestration">OwlH Master Orchestration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="OwlHsoftwaretap.html#prepare-owlh-master-software">Prepare OwlH Master software</a></li>
<li class="toctree-l3"><a class="reference internal" href="OwlHsoftwaretap.html#owlh-master-ssh-key">OwlH Master ssh Key</a></li>
<li class="toctree-l3"><a class="reference internal" href="OwlHsoftwaretap.html#create-dummy-interface-for-network-ids">Create Dummy interface for Network IDS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="OwlHsoftwaretap.html#network-ids-support">Network IDS support</a><ul>
<li class="toctree-l3"><a class="reference internal" href="OwlHsoftwaretap.html#continuous-network-ids-monitor-and-sniffing">Continuous Network IDS monitor and sniffing</a></li>
<li class="toctree-l3"><a class="reference internal" href="OwlHsoftwaretap.html#deploy-suricata-as-network-ids">Deploy Suricata as Network IDS</a></li>
<li class="toctree-l3"><a class="reference internal" href="OwlHsoftwaretap.html#deploy-bro-as-network-ids">Deploy Bro as Network IDS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="OwlHsoftwaretap.html#owlh-master-configuration">OwlH Master Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="OwlHsoftwaretap.html#target-instances">Target Instances</a></li>
<li class="toctree-l2"><a class="reference internal" href="OwlHsoftwaretap.html#register-your-servers">Register your servers</a></li>
<li class="toctree-l2"><a class="reference internal" href="OwlHsoftwaretap.html#wazuh-system">Wazuh system</a></li>
<li class="toctree-l2"><a class="reference internal" href="OwlHsoftwaretap.html#integrate-owlh-master-with-wazuh">Integrate OwlH master with Wazuh</a></li>
<li class="toctree-l2"><a class="reference internal" href="OwlHsoftwaretap.html#enjoy-it">Enjoy It</a></li>
<li class="toctree-l2"><a class="reference internal" href="OwlHsoftwaretap.html#if-you-need-help">If you need help:</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">owlh</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>OwlH for PCI</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/main/OwlHPCI.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="owlh-for-pci">
<h1>OwlH for PCI<a class="headerlink" href="#owlh-for-pci" title="Permalink to this headline">¶</a></h1>
<div class="section" id="owlh-can-help-you-to-demonstrate-compliance-with-requirements">
<h2>OwlH can help you to demonstrate compliance with requirements:<a class="headerlink" href="#owlh-can-help-you-to-demonstrate-compliance-with-requirements" title="Permalink to this headline">¶</a></h2>
<p>Download OwlH PCI-DSS v3.2 Mapping - <a class="reference external" href="https://drive.google.com/file/d/1IfC23AHSULjY6GKmXG_S5ZIUWKEMyB33/view?usp=sharing">owlh_pcidss_3.2.pdf</a></p>
</div>
<div class="section" id="define-your-custom-rules-to-detect-compliance-related-traffic">
<h2>Define your custom rules to detect compliance related traffic:<a class="headerlink" href="#define-your-custom-rules-to-detect-compliance-related-traffic" title="Permalink to this headline">¶</a></h2>
<p>OwlH team will help you to define rules that will identify traffic that can be related to PCI requirements like unencrypted traffic between PCI related systems. Use of unknown services from PCI network to external servers, Firewall policy violations when publishing internal services.</p>
</div>
<div class="section" id="how-to-apply-suricata-pci-mapping">
<h2>How to apply Suricata PCI Mapping<a class="headerlink" href="#how-to-apply-suricata-pci-mapping" title="Permalink to this headline">¶</a></h2>
<p>This must be run on every Wazuh logstash server and it will:</p>
<ul class="simple">
<li>Modify logstash configuration file to include OwlH PCI-DSS 3.2 mapping schema</li>
<li>Copy OwlH suricata ET ruleset PCI-DSS mapping to config folder</li>
<li>Restart logstash</li>
</ul>
<p>Please, download configuration script</p>
<blockquote>
<div><code class="docutils literal"><span class="pre">$</span> <span class="pre">curl</span> <span class="pre">-so</span> <span class="pre">/tmp/owlhconfig.sh</span> <span class="pre">https://raw.githubusercontent.com/owlh/wazuhenrichment/master/owlhconfig.sh</span></code></div></blockquote>
<p>and then run it</p>
<blockquote>
<div><code class="docutils literal"><span class="pre">$</span> <span class="pre">sudo</span> <span class="pre">bash</span> <span class="pre">/tmp/owlhconfig.sh</span></code></div></blockquote>
</div>
<div class="section" id="how-to-manage-and-custom-your-suricata-pci-mapping">
<h2>How to manage and custom your Suricata PCI Mapping<a class="headerlink" href="#how-to-manage-and-custom-your-suricata-pci-mapping" title="Permalink to this headline">¶</a></h2>
<p>Please download the script that will allow you to manage your compliance mapping</p>
<blockquote>
<div><code class="docutils literal"><span class="pre">$</span> <span class="pre">curl</span> <span class="pre">-so</span> <span class="pre">/tmp/owlh-suri2pci.sh</span> <span class="pre">https://raw.githubusercontent.com/owlh/owlhpci/master/owlh-suri2pci.sh</span></code></div></blockquote>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="o">./</span><span class="n">owlh</span><span class="o">-</span><span class="n">suri2pci</span><span class="o">.</span><span class="n">sh</span> <span class="o">-</span><span class="n">a</span><span class="o">|</span><span class="n">ls</span><span class="o">|</span><span class="n">lc</span><span class="o">|</span><span class="n">m</span><span class="o">|</span><span class="n">d</span> <span class="o">-</span><span class="n">s</span> <span class="n">sid</span> <span class="o">-</span><span class="n">c</span> <span class="n">pci</span><span class="o">-</span><span class="n">controls</span> <span class="o">-</span><span class="n">b</span> <span class="n">bulk_file</span>  <span class="n">pci_map_file</span>

      <span class="o">-</span><span class="n">a</span><span class="o">|--</span><span class="n">append</span>       <span class="o">-</span> <span class="n">append</span> <span class="n">sid</span> <span class="ow">and</span> <span class="n">pci</span><span class="o">-</span><span class="n">dss</span> <span class="n">related</span> <span class="n">controls</span> <span class="n">to</span> <span class="nb">map</span> <span class="n">file</span>
      <span class="o">-</span><span class="n">d</span><span class="o">|--</span><span class="n">delete</span>       <span class="o">-</span> <span class="n">sid</span> <span class="ow">and</span> <span class="n">pci</span><span class="o">-</span><span class="n">dss</span> <span class="n">related</span> <span class="n">controls</span> <span class="kn">from</span> <span class="nn">map</span> <span class="n">file</span>
      <span class="o">-</span><span class="n">ls</span><span class="o">|--</span><span class="n">listsid</span>     <span class="o">-</span> <span class="nb">list</span> <span class="n">pci</span> <span class="n">controlers</span> <span class="n">related</span> <span class="k">with</span> <span class="n">a</span> <span class="n">sid</span> <span class="ow">or</span> <span class="n">group</span> <span class="n">of</span> <span class="n">sids</span> <span class="p">(</span><span class="n">grep</span><span class="p">)</span>
      <span class="o">-</span><span class="n">lc</span><span class="o">|--</span><span class="n">listctrl</span>    <span class="o">-</span> <span class="nb">list</span> <span class="n">sids</span> <span class="n">that</span> <span class="n">are</span> <span class="n">associated</span> <span class="k">with</span> <span class="n">pci</span> <span class="n">control</span>
      <span class="o">-</span><span class="n">m</span><span class="o">|--</span><span class="n">modify</span>       <span class="o">-</span> <span class="n">modify</span> <span class="n">sid</span> <span class="ow">and</span> <span class="n">pci</span> <span class="n">mapping</span>
      <span class="o">-</span><span class="n">s</span><span class="o">|--</span><span class="n">sid</span>          <span class="o">-</span> <span class="n">sid</span> <span class="n">number</span>
      <span class="o">-</span><span class="n">c</span><span class="o">|--</span><span class="n">control</span>      <span class="o">-</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">controls</span> <span class="n">comma</span> <span class="n">separated</span>
</pre></div>
</div>
<div class="section" id="if-you-need-help">
<h3>If you need help:<a class="headerlink" href="#if-you-need-help" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>email our support team - <a class="reference external" href="mailto:support&#37;&#52;&#48;owlh&#46;net">support<span>&#64;</span>owlh<span>&#46;</span>net</a></li>
<li>visit our mailing list - <a class="reference external" href="https://groups.google.com/d/forum/owlh">OwlH mailing list</a> (<a class="reference external" href="mailto:owlh&#37;&#52;&#48;googlegroups&#46;com">owlh<span>&#64;</span>googlegroups<span>&#46;</span>com</a>)</li>
</ul>
<p><strong>OwlH - current v0.7 - Jan : OwlH Node and Master API</strong></p>
<p>documentation last updated - Feb 09, 2019</p>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="OwlHsoftwaretap.html" class="btn btn-neutral float-right" title="Software TAP for AWS and GCloud" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="OwlHBro.html" class="btn btn-neutral" title="OwlH - Zeek and Wazuh" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, owlh team.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.4 - Cloud and Bro',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>